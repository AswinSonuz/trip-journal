<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scrapbook Diary</title>

<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Inter:wght@400;500&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}

/* Background */
body{
  margin:0;
  background:#e9e4db;
  font-family:'Inter';
  color:#2b2b2b;
}

/* Header */
header{
  padding:20px;
  text-align:center;
  font-size:26px;
  font-family:'Patrick Hand';
  background:#fff;
  border-bottom:2px dashed #d3cbbb;
}

/* Layout */
.container{
  max-width:480px;
  margin:auto;
  padding:16px;
}

/* Controls */
.controls{
  background:#fff;
  padding:18px;
  border-radius:22px;
  box-shadow:0 12px 30px rgba(0,0,0,.08);
  margin-bottom:20px;
}

input, textarea, select{
  width:100%;
  padding:12px;
  margin-bottom:10px;
  border-radius:12px;
  border:1px solid #ddd;
  background:#fffdf8;
}

textarea{resize:none;height:70px}

button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:16px;
  background:#2b2b2b;
  color:#fff;
  font-size:15px;
}

/* Diary */
.diary{
  display:flex;
  flex-direction:column;
  gap:30px;
}

/* Page */
.page{
  position:relative;
  padding:18px;
  border-radius:14px;
  box-shadow:0 16px 40px rgba(0,0,0,.15);
  transform:rotate(var(--rotate));
  background:var(--paper);
}

/* Paper textures */
.paper-plain{--paper:#fff;}
.paper-beige{--paper:#fdf6e3;}
.paper-kraft{--paper:#f3e7d3;}
.paper-ruled{
  --paper:repeating-linear-gradient(
    #fff,
    #fff 22px,
    #f1f1f1 23px
  );
}

/* Tape */
.page::before{
  content:'';
  position:absolute;
  top:-10px;
  left:30%;
  width:40%;
  height:18px;
  background:rgba(255,235,150,.7);
  border-radius:4px;
}

/* Date */
.date{
  font-family:'Patrick Hand';
  font-size:14px;
  opacity:.6;
}

/* Polaroid */
.photo{
  background:#fff;
  padding:8px 8px 18px;
  margin:12px 0;
  border-radius:6px;
  box-shadow:0 6px 16px rgba(0,0,0,.2);
  cursor:grab;
}

.photo img{
  width:100%;
  border-radius:4px;
}

/* Text */
.page h3{
  font-family:'Patrick Hand';
  font-size:20px;
  margin:6px 0;
}

.note{
  font-family:'Patrick Hand';
  font-size:16px;
  cursor:grab;
}

/* Sticker */
.sticker{
  position:absolute;
  bottom:-12px;
  right:-10px;
  font-size:34px;
  cursor:grab;
}

/* Backup */
.backup{
  margin:24px 0;
}

/* Print */
@media print{
  body{background:#fff}
  .controls,.backup,header{display:none}
  .page{
    page-break-after:always;
    transform:none;
    box-shadow:none;
  }
}
</style>
</head>

<body>

<header>My Scrapbook Diary</header>

<div class="container">

<!-- Controls -->
<div class="controls">
  <input id="title" placeholder="Place / Moment">
  <textarea id="text" placeholder="What happened, what you felt‚Ä¶"></textarea>

  <select id="paper">
    <option value="paper-plain">Plain Paper</option>
    <option value="paper-beige">Beige Journal</option>
    <option value="paper-kraft">Kraft Paper</option>
    <option value="paper-ruled">Ruled Notebook</option>
  </select>

  <select id="sticker">
    <option value="‚ú®">‚ú® Sparkle</option>
    <option value="‚ù§Ô∏è">‚ù§Ô∏è Heart</option>
    <option value="üì∏">üì∏ Camera</option>
    <option value="üå∏">üå∏ Flower</option>
    <option value="‚òï">‚òï Coffee</option>
    <option value="üìñ">üìñ Book</option>
  </select>

  <input type="file" id="photo" accept="image/*">
  <button onclick="addPage()">Add Page</button>
</div>

<!-- Diary -->
<div class="diary" id="diary"></div>

<!-- Backup -->
<div class="backup">
  <button onclick="exportBackup()">Backup Diary</button>
  <input type="file" accept="application/json" onchange="importBackup(event)">
</div>

</div>

<script>
let pages = JSON.parse(localStorage.getItem("scrapbookDiary")) || [];

function save(){
  localStorage.setItem("scrapbookDiary", JSON.stringify(pages));
}

function addPage(){
  if(!title.value) return alert("Add a title");

  const page={
    title:title.value,
    text:text.value,
    sticker:sticker.value,
    paper:paper.value,
    date:new Date().toDateString(),
    rotate:(Math.random()*6-3)+"deg",
    image:null
  };

  const file=photo.files[0];
  if(file){
    const reader=new FileReader();
    reader.onload=()=>{
      page.image=reader.result;
      pages.unshift(page);
      save(); render();
    };
    reader.readAsDataURL(file);
  }else{
    pages.unshift(page);
    save(); render();
  }

  title.value=text.value="";
  photo.value="";
}

function render(){
  const d=document.getElementById("diary");
  d.innerHTML="";

  pages.forEach(p=>{
    const div=document.createElement("div");
    div.className=`page ${p.paper}`;
    div.style.setProperty("--rotate",p.rotate);

    div.innerHTML=`
      <div class="date">${p.date}</div>
      <h3>${p.title}</h3>
      ${p.image?`<div class="photo draggable"><img src="${p.image}"></div>`:""}
      <div class="note draggable">${p.text}</div>
      <div class="sticker draggable">${p.sticker}</div>
    `;
    d.appendChild(div);
  });

  makeDraggable();
}

/* Drag logic */
function makeDraggable(){
  document.querySelectorAll(".draggable").forEach(el=>{
    let offsetX, offsetY, dragging=false;

    el.addEventListener("pointerdown",e=>{
      dragging=true;
      el.setPointerCapture(e.pointerId);
      offsetX=e.clientX-el.offsetLeft;
      offsetY=e.clientY-el.offsetTop;
    });

    el.addEventListener("pointermove",e=>{
      if(!dragging) return;
      el.style.position="absolute";
      el.style.left=(e.clientX-offsetX)+"px";
      el.style.top=(e.clientY-offsetY)+"px";
    });

    el.addEventListener("pointerup",()=>dragging=false);
  });
}

/* Backup */
function exportBackup(){
  const blob=new Blob([JSON.stringify(pages,null,2)],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="scrapbook-diary-backup.json";
  a.click();
}

function importBackup(e){
  const file=e.target.files[0];
  if(!file) return;
  const reader=new FileReader();
  reader.onload=()=>{
    pages=JSON.parse(reader.result);
    save(); render();
  };
  reader.readAsText(file);
}

render();
</script>

</body>
</html>