<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trip Journal</title>

<!-- Google APIs -->
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script src="https://apis.google.com/js/api.js"></script>

<!-- Font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;font-family:Inter}
body{
  margin:0;
  background:#0f1117;
  color:#fff;
}
header{
  padding:18px;
  text-align:center;
  font-size:20px;
  font-weight:700;
  background:linear-gradient(135deg,#1f2937,#111827);
}
.container{padding:16px}
.card{
  background:#181b23;
  border-radius:18px;
  padding:16px;
  margin-bottom:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.4)
}
h3{margin:0 0 10px;font-size:16px}
input,textarea,button{
  width:100%;
  border:none;
  border-radius:12px;
  padding:12px;
  margin-bottom:10px;
  background:#0b0e14;
  color:#fff;
  outline:none;
}
textarea{resize:none;height:80px}
button{
  background:linear-gradient(135deg,#ff8a00,#ff5f6d);
  font-weight:600;
}
.place{display:flex;gap:10px;margin-bottom:8px}
.journal{
  background:#fff;
  color:#111;
  border-radius:20px;
  padding:18px;
}
.journal img{
  width:100%;
  border-radius:14px;
  margin-top:10px;
}
.small{font-size:13px;opacity:.7}

/* EXPORT PAGE (Pinterest Style) */
.export-page{
  background:#fdfcfb;
  color:#111;
  padding:24px;
}
.export-page h1{font-size:28px;margin-bottom:6px}
.export-page .date{font-size:13px;opacity:.6;margin-bottom:24px}
.entry{margin-bottom:42px}
.entry img{width:100%;border-radius:18px;margin:14px 0}
.entry h2{margin:0;font-size:22px}
.entry p{font-size:15px;line-height:1.7;margin:8px 0}
.tag{
  display:inline-block;
  background:#eee;
  padding:6px 12px;
  border-radius:20px;
  font-size:12px;
}
</style>
</head>

<body>

<header>My Trip Journal</header>

<div class="container">

<div class="card">
  <button onclick="authenticate()">Sign in with Google</button>
  <button onclick="generateJournal()">Generate Journal Page</button>
  <p class="small">Your journal is stored privately in your Google Drive</p>
</div>

<div class="card">
  <h3>Places Visited (Kerala)</h3>
  <div class="place"><input type="checkbox">Munnar</div>
  <div class="place"><input type="checkbox">Varkala</div>
  <div class="place"><input type="checkbox">Alappuzha</div>
  <div class="place"><input type="checkbox">Wayanad</div>
  <div class="place"><input type="checkbox">Fort Kochi</div>
  <div class="place"><input type="checkbox">Athirappilly</div>
</div>

<div class="card">
  <h3>Add New Place</h3>
  <input id="placeName" placeholder="Place name">
  <textarea id="memory" placeholder="Memory / Description"></textarea>
  <textarea id="learned" placeholder="Things I learned"></textarea>
  <textarea id="change" placeholder="How this place changed me"></textarea>
  <input type="file" id="photo" accept="image/*">
  <button onclick="addEntry()">Save to Journal</button>
</div>

<div class="card journal" id="journal">
  <h2>Trip Journal</h2>
  <p class="small">Sign in to load your memories ✨</p>
</div>

</div>

<script>
/* CONFIG */
const CLIENT_ID = "187448431724-6pf99s65uq17im0ddkaugl20h88f3nir.apps.googleusercontent.com";
const SCOPES = "https://www.googleapis.com/auth/drive.file";
const FILE_NAME = "TripJournal.json";

/* STATE */
let tokenClient;
let journalData = [];
let fileId = null;

/* AUTH */
function authenticate(){
  tokenClient = google.accounts.oauth2.initTokenClient({
    client_id: CLIENT_ID,
    scope: SCOPES,
    callback: (token)=>{
      gapi.client.setToken(token);
      initDrive();
    }
  });
  tokenClient.requestAccessToken();
}

/* DRIVE INIT */
function initDrive(){
  gapi.load("client", ()=>{
    gapi.client.load("drive","v3", findOrCreateFile);
  });
}

/* FIND OR CREATE FILE */
function findOrCreateFile(){
  gapi.client.drive.files.list({
    q:`name='${FILE_NAME}'`,
    fields:"files(id,name)"
  }).then(res=>{
    if(res.result.files.length){
      fileId = res.result.files[0].id;
      loadFile();
    } else {
      createFile();
    }
  });
}

function createFile(){
  const blob = new Blob([JSON.stringify([])],{type:"application/json"});
  gapi.client.drive.files.create({
    resource:{name:FILE_NAME},
    media:{mimeType:"application/json",body:blob}
  }).then(res=>{
    fileId = res.result.id;
    journalData = [];
    renderJournal();
  });
}

function loadFile(){
  gapi.client.drive.files.get({
    fileId,
    alt:"media"
  }).then(res=>{
    journalData = JSON.parse(res.body || "[]");
    renderJournal();
  });
}

function saveFile(){
  const blob = new Blob([JSON.stringify(journalData)],{type:"application/json"});
  gapi.client.drive.files.update({
    fileId,
    media:{mimeType:"application/json",body:blob}
  });
}

/* ADD ENTRY */
function addEntry(){
  if(!fileId) return alert("Sign in first");

  const entry={
    place:placeName.value,
    memory:memory.value,
    learned:learned.value,
    change:change.value,
    image:null
  };

  if(!entry.place) return alert("Place name required");

  const file = photo.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload=()=>{
      entry.image = reader.result;
      journalData.push(entry);
      saveFile();
      renderJournal();
    };
    reader.readAsDataURL(file);
  } else {
    journalData.push(entry);
    saveFile();
    renderJournal();
  }

  placeName.value=memory.value=learned.value=change.value="";
  photo.value="";
}

/* RENDER */
function renderJournal(){
  const j=document.getElementById("journal");
  j.innerHTML="<h2>Trip Journal</h2>";

  journalData.forEach(e=>{
    j.innerHTML+=`
      <h3>${e.place}</h3>
      ${e.image?`<img src="${e.image}">`:""}
      <p><b>Memory:</b> ${e.memory}</p>
      <p><b>Learned:</b> ${e.learned}</p>
      <p><b>Change:</b> ${e.change}</p>
      <hr>
    `;
  });
}

/* PINTEREST STYLE EXPORT */
function generateJournal(){
  if(!journalData.length) return alert("No entries yet");

  const win = window.open("","_blank");
  let html = `
  <html><head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>${document.querySelector("style").innerHTML}</style>
  </head>
  <body class="export-page">
  <h1>My Trip Journal</h1>
  <div class="date">${new Date().toDateString()}</div>
  `;

  journalData.forEach(e=>{
    html+=`
      <div class="entry">
        <h2>${e.place}</h2>
        ${e.image?`<img src="${e.image}">`:""}
        ${e.memory?`<p><b>Memory</b><br>${e.memory}</p>`:""}
        ${e.learned?`<p><b>What I learned</b><br>${e.learned}</p>`:""}
        ${e.change?`<p><b>How it changed me</b><br>${e.change}</p>`:""}
        <div class="tag">Travel Journal</div>
      </div>
    `;
  });

  html+=`<script>window.onload=()=>window.print();<\/script></body></html>`;
  win.document.write(html);
  win.document.close();
}
</script>

</body>
</html>
</div>

<script>
/* CONFIG */
const CLIENT_ID = "<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trip Journal</title>

<!-- Google APIs -->
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script src="https://apis.google.com/js/api.js"></script>

<!-- Font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;font-family:Inter}
body{
  margin:0;
  background:#0f1117;
  color:#fff;
}
header{
  padding:18px;
  text-align:center;
  font-size:20px;
  font-weight:700;
  background:linear-gradient(135deg,#1f2937,#111827);
}
.container{padding:16px}
.card{
  background:#181b23;
  border-radius:18px;
  padding:16px;
  margin-bottom:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.4)
}
h3{margin:0 0 10px;font-size:16px}
input,textarea,button{
  width:100%;
  border:none;
  border-radius:12px;
  padding:12px;
  margin-bottom:10px;
  background:#0b0e14;
  color:#fff;
  outline:none;
}
textarea{resize:none;height:80px}
button{
  background:linear-gradient(135deg,#ff8a00,#ff5f6d);
  font-weight:600;
}
.place{display:flex;gap:10px;margin-bottom:8px}
.journal{
  background:#fff;
  color:#111;
  border-radius:20px;
  padding:18px;
}
.journal img{
  width:100%;
  border-radius:14px;
  margin-top:10px;
}
.small{font-size:13px;opacity:.7}

/* EXPORT PAGE (Pinterest Style) */
.export-page{
  background:#fdfcfb;
  color:#111;
  padding:24px;
}
.export-page h1{font-size:28px;margin-bottom:6px}
.export-page .date{font-size:13px;opacity:.6;margin-bottom:24px}
.entry{margin-bottom:42px}
.entry img{width:100%;border-radius:18px;margin:14px 0}
.entry h2{margin:0;font-size:22px}
.entry p{font-size:15px;line-height:1.7;margin:8px 0}
.tag{
  display:inline-block;
  background:#eee;
  padding:6px 12px;
  border-radius:20px;
  font-size:12px;
}
</style>
</head>

<body>

<header>My Trip Journal</header>

<div class="container">

<div class="card">
  <button onclick="authenticate()">Sign in with Google</button>
  <button onclick="generateJournal()">Generate Journal Page</button>
  <p class="small">Your journal is stored privately in your Google Drive</p>
</div>

<div class="card">
  <h3>Places Visited (Kerala)</h3>
  <div class="place"><input type="checkbox">Munnar</div>
  <div class="place"><input type="checkbox">Varkala</div>
  <div class="place"><input type="checkbox">Alappuzha</div>
  <div class="place"><input type="checkbox">Wayanad</div>
  <div class="place"><input type="checkbox">Fort Kochi</div>
  <div class="place"><input type="checkbox">Athirappilly</div>
</div>

<div class="card">
  <h3>Add New Place</h3>
  <input id="placeName" placeholder="Place name">
  <textarea id="memory" placeholder="Memory / Description"></textarea>
  <textarea id="learned" placeholder="Things I learned"></textarea>
  <textarea id="change" placeholder="How this place changed me"></textarea>
  <input type="file" id="photo" accept="image/*">
  <button onclick="addEntry()">Save to Journal</button>
</div>

<div class="card journal" id="journal">
  <h2>Trip Journal</h2>
  <p class="small">Sign in to load your memories ✨</p>
</div>

</div>

<script>
/* CONFIG */
const CLIENT_ID = "YOUR_CLIENT_ID_HERE";
const SCOPES = "https://www.googleapis.com/auth/drive.file";
const FILE_NAME = "TripJournal.json";

/* STATE */
let tokenClient;
let journalData = [];
let fileId = null;

/* AUTH */
function authenticate(){
  tokenClient = google.accounts.oauth2.initTokenClient({
    client_id: CLIENT_ID,
    scope: SCOPES,
    callback: (token)=>{
      gapi.client.setToken(token);
      initDrive();
    }
  });
  tokenClient.requestAccessToken();
}

/* DRIVE INIT */
function initDrive(){
  gapi.load("client", ()=>{
    gapi.client.load("drive","v3", findOrCreateFile);
  });
}

/* FIND OR CREATE FILE */
function findOrCreateFile(){
  gapi.client.drive.files.list({
    q:`name='${FILE_NAME}'`,
    fields:"files(id,name)"
  }).then(res=>{
    if(res.result.files.length){
      fileId = res.result.files[0].id;
      loadFile();
    } else {
      createFile();
    }
  });
}

function createFile(){
  const blob = new Blob([JSON.stringify([])],{type:"application/json"});
  gapi.client.drive.files.create({
    resource:{name:FILE_NAME},
    media:{mimeType:"application/json",body:blob}
  }).then(res=>{
    fileId = res.result.id;
    journalData = [];
    renderJournal();
  });
}

function loadFile(){
  gapi.client.drive.files.get({
    fileId,
    alt:"media"
  }).then(res=>{
    journalData = JSON.parse(res.body || "[]");
    renderJournal();
  });
}

function saveFile(){
  const blob = new Blob([JSON.stringify(journalData)],{type:"application/json"});
  gapi.client.drive.files.update({
    fileId,
    media:{mimeType:"application/json",body:blob}
  });
}

/* ADD ENTRY */
function addEntry(){
  if(!fileId) return alert("Sign in first");

  const entry={
    place:placeName.value,
    memory:memory.value,
    learned:learned.value,
    change:change.value,
    image:null
  };

  if(!entry.place) return alert("Place name required");

  const file = photo.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload=()=>{
      entry.image = reader.result;
      journalData.push(entry);
      saveFile();
      renderJournal();
    };
    reader.readAsDataURL(file);
  } else {
    journalData.push(entry);
    saveFile();
    renderJournal();
  }

  placeName.value=memory.value=learned.value=change.value="";
  photo.value="";
}

/* RENDER */
function renderJournal(){
  const j=document.getElementById("journal");
  j.innerHTML="<h2>Trip Journal</h2>";

  journalData.forEach(e=>{
    j.innerHTML+=`
      <h3>${e.place}</h3>
      ${e.image?`<img src="${e.image}">`:""}
      <p><b>Memory:</b> ${e.memory}</p>
      <p><b>Learned:</b> ${e.learned}</p>
      <p><b>Change:</b> ${e.change}</p>
      <hr>
    `;
  });
}

/* PINTEREST STYLE EXPORT */
function generateJournal(){
  if(!journalData.length) return alert("No entries yet");

  const win = window.open("","_blank");
  let html = `
  <html><head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>${document.querySelector("style").innerHTML}</style>
  </head>
  <body class="export-page">
  <h1>My Trip Journal</h1>
  <div class="date">${new Date().toDateString()}</div>
  `;

  journalData.forEach(e=>{
    html+=`
      <div class="entry">
        <h2>${e.place}</h2>
        ${e.image?`<img src="${e.image}">`:""}
        ${e.memory?`<p><b>Memory</b><br>${e.memory}</p>`:""}
        ${e.learned?`<p><b>What I learned</b><br>${e.learned}</p>`:""}
        ${e.change?`<p><b>How it changed me</b><br>${e.change}</p>`:""}
        <div class="tag">Travel Journal</div>
      </div>
    `;
  });

  html+=`<script>window.onload=()=>window.print();<\/script></body></html>`;
  win.document.write(html);
  win.document.close();
}
</script>

</body>
</html>";
const SCOPES = "https://www.googleapis.com/auth/drive.file";
const FILE_NAME = "TripJournal.json";

/* STATE */
let tokenClient;
let journalData = [];
let fileId = null;

/* AUTH */
function authenticate(){
  tokenClient = google.accounts.oauth2.initTokenClient({
    client_id: CLIENT_ID,
    scope: SCOPES,
    callback: (token)=>{
      gapi.client.setToken(token);
      initDrive();
    }
  });
  tokenClient.requestAccessToken();
}

/* DRIVE INIT */
function initDrive(){
  gapi.load("client", ()=>{
    gapi.client.load("drive","v3", findOrCreateFile);
  });
}

/* FIND OR CREATE FILE */
function findOrCreateFile(){
  gapi.client.drive.files.list({
    q:`name='${FILE_NAME}'`,
    fields:"files(id,name)"
  }).then(res=>{
    if(res.result.files.length){
      fileId = res.result.files[0].id;
      loadFile();
    } else {
      createFile();
    }
  });
}

function createFile(){
  const blob = new Blob([JSON.stringify([])],{type:"application/json"});
  gapi.client.drive.files.create({
    resource:{name:FILE_NAME},
    media:{mimeType:"application/json",body:blob}
  }).then(res=>{
    fileId = res.result.id;
    journalData = [];
    renderJournal();
  });
}

function loadFile(){
  gapi.client.drive.files.get({
    fileId,
    alt:"media"
  }).then(res=>{
    journalData = JSON.parse(res.body || "[]");
    renderJournal();
  });
}

function saveFile(){
  const blob = new Blob([JSON.stringify(journalData)],{type:"application/json"});
  gapi.client.drive.files.update({
    fileId,
    media:{mimeType:"application/json",body:blob}
  });
}

/* ADD ENTRY */
function addEntry(){
  if(!fileId) return alert("Sign in first");

  const entry={
    place:placeName.value,
    memory:memory.value,
    learned:learned.value,
    change:change.value,
    image:null
  };

  if(!entry.place) return alert("Place name required");

  const file = photo.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload=()=>{
      entry.image = reader.result;
      journalData.push(entry);
      saveFile();
      renderJournal();
    };
    reader.readAsDataURL(file);
  } else {
    journalData.push(entry);
    saveFile();
    renderJournal();
  }

  placeName.value=memory.value=learned.value=change.value="";
  photo.value="";
}

/* RENDER */
function renderJournal(){
  const j=document.getElementById("journal");
  j.innerHTML="<h2>Trip Journal</h2>";

  journalData.forEach(e=>{
    j.innerHTML+=`
      <h3>${e.place}</h3>
      ${e.image?`<img src="${e.image}">`:""}
      <p><b>Memory:</b> ${e.memory}</p>
      <p><b>Learned:</b> ${e.learned}</p>
      <p><b>Change:</b> ${e.change}</p>
      <hr>
    `;
  });
}

/* PINTEREST STYLE EXPORT */
function generateJournal(){
  if(!journalData.length) return alert("No entries yet");

  const win = window.open("","_blank");
  let html = `
  <html><head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>${document.querySelector("style").innerHTML}</style>
  </head>
  <body class="export-page">
  <h1>My Trip Journal</h1>
  <div class="date">${new Date().toDateString()}</div>
  `;

  journalData.forEach(e=>{
    html+=`
      <div class="entry">
        <h2>${e.place}</h2>
        ${e.image?`<img src="${e.image}">`:""}
        ${e.memory?`<p><b>Memory</b><br>${e.memory}</p>`:""}
        ${e.learned?`<p><b>What I learned</b><br>${e.learned}</p>`:""}
        ${e.change?`<p><b>How it changed me</b><br>${e.change}</p>`:""}
        <div class="tag">Travel Journal</div>
      </div>
    `;
  });

  html+=`<script>window.onload=()=>window.print();<\/script></body></html>`;
  win.document.write(html);
  win.document.close();
}
</script>

</body>
</html>
